title: ES2018æ–°ç‰¹æ€§å­¦ä¹ 
date: 2019-01-23 20:33:40
tags:
---

ESå…¨ç§°ECMAScriptï¼Œä¸‹é¢å°†ä¼šåˆ—å‡ºES2018ï¼ˆES9ï¼‰ä¸­å·²ç»è¿›å…¥stage-4çš„æ–°ç‰¹æ€§ã€‚

## æ–°ç‰¹æ€§åˆ—è¡¨

ES2018æ–°ç‰¹æ€§æœ‰ï¼š

1.å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦<br/>
2.æ­£åˆ™è¡¨è¾¾å¼çš„æ”¹è¿›<br/>
3.å¼‚æ­¥è¿­ä»£å™¨å’Œå¼‚æ­¥ç”Ÿæˆå™¨<br/>
4.Promiseçš„finallyå›è°ƒ

## ä¸€ã€å¯¹è±¡çš„æ‹“å±•è¿ç®—ç¬¦

æ‹“å±•è¿ç®—ç¬¦ï¼Œä¹Ÿå«Rest/Spreadï¼Œåœ¨ES6æ—¶æå‡ºäº†æ•°ç»„çš„æ‰©å±•è¿ç®—ç¬¦ï¼Œä»…ç”¨äºæ•°ç»„ï¼Œè€Œåœ¨ES9ä¸­åˆ™æ–°å¢äº†å¯¹è±¡çš„æ‹“å±•è¿ç®—ç¬¦ã€‚æ‰©å±•è¿ç®—ç¬¦ç”¨`...`è¡¨ç¤ºã€‚

#### ç”¨æ³•ï¼š

**ES6:**

example1:

```
const arr = [1,2,3,4,5];
const [a,b,...c] = arr;

console.log(a,b); //1 2
console.log(c);  //[3,4,5]

```

example2:

```
const nums = [23,12,3,12,3];
const result = Math.max(...nums);

console.log(result);    //23
```

**ES9:**

example3:

```
const obj = { a : 1 , b : 2 , c : 3 , d : 4};
const {a , b , ...z} = obj;

console.log(a,b);   //1 2
console.log(z);     // { c : 3 , d : 4}
```

example4:

```
const obj1 = { a : 1 , b : 2};
const obj2 = {c : 3 , d : 4};

const obj3 = {...obj1 , ...obj2}; //åˆå¹¶å¯¹è±¡

console.log(obj3);      //{ a : 1 , b : 2 , c : 3 , d : 4};
```

#### æ³¨æ„ï¼š

1.è§£æ„èµ‹å€¼å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

2.è§£æ„èµ‹å€¼çš„åçš„å¯¹è±¡åˆ›å»ºçš„æ˜¯æ–°çš„å¼•ç”¨ã€‚

```
const obj1 = { a : 1}; 
const {...obj2} = obj1; 

console.log(obj2);  //{ a : 1}

obj1.a = 2;

console.log(obj1);  // { a : 2}
console.log(obj2);  //{ a : 1}
```

<br/>

## äºŒã€æ­£åˆ™è¡¨è¾¾å¼çš„æ”¹è¿›

åœ¨ES9ä¸­ï¼Œå¯¹äºæ­£åˆ™è¡¨è¾¾å¼çš„æ”¹è¿›ä¸»è¦æœ‰å››ä¸ªæ–¹é¢ï¼š

1.ä½ç½®è¿ç®—ç¬¦
2.Unicodeè½¬ä¹‰
3.å‘½åæ•è·ç»„
4.ä¿®é¥°ç¬¦s

#### ç”¨æ³•ï¼š

##### 1.ä½ç½®ä¿®é¥°ç¬¦

ä½ç½®ä¿®é¥°ç¬¦ä¸»è¦æœ‰å››ä¸ªï¼š

**`q?=p`** ï¼šæ•è·qçš„åé¢æ˜¯æœ‰pçš„å­—ç¬¦ä¸²

```
const reg = /hello(?= world)/;

reg.test('a hello world sentences');    //true
reg.test('a hello kugou');    //false
```

<br/>

**`q?!p`** ï¼šæ•è·qçš„åé¢ä¸ä¸ºpçš„å­—ç¬¦ä¸²

```
const reg = /hello(?= world)/;

reg.test('a hello world sentences');    //false
reg.test('a hello kugou');    //true
```

<br/>


**`(?<=q)p`** ï¼šæ•è·på‰é¢æœ‰qçš„å­—ç¬¦ä¸²

```
const reg = /(?<=hello) world/;

reg.test('a hello world sentences');    //true
reg.test('a haha kugou');  //false
```

<br/>

**`(?<!q)p`** ï¼šæ•è·på‰é¢æ²¡æœ‰qçš„å­—ç¬¦ä¸²

```
const reg = /(?<!hello) world/;

reg.test('a hello world sentences');    //false
reg.test('a haha world');  //true
```

<br/>

##### 2.Unicodeè½¬ä¹‰

Unicodeè½¬ä¹‰å¯ä»¥é€šè¿‡`\p{...}`æ•è·ï¼Œ`\P{...}`æ•è·çš„æ˜¯ä¸ç¬¦åˆè½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¤§æ‹¬å·å†…å¯ä»¥ä¼ å…¥ä¸åŒç±»å‹çš„unicodeå­—ç¬¦å…³é”®å­—ï¼Œä»¥ä¸‹æ˜¯ä¸åŒunicodeå­—ç¬¦å…³é”®å­—çš„ç¤ºä¾‹ï¼š

**ASCII** ï¼šæ•è·ASCII å­—ç¬¦é›†çš„å­—ç¬¦ä¸²

```
const reg = /^\p{ASCII}+$/u;

reg.test('abc');    //true
reg.test('abcğŸ™ƒ');  //false
```

**ASCII_Hex_Digit** ï¼š æ•è·16è¿›åˆ¶æ•°å­—å­—ç¬¦ä¸²

```
const reg = /^\p{ASCII_Hex_Digit}+$/u;

reg.test('012EF');  //true
reg.test('G');  //false
```

**Uppercase/Lowercase** ï¼š æ•è·å¤§æˆ–å°å†™çš„å­—ç¬¦ä¸²

```
/\p{Uppercase}/u.test('A'); //true
/\p{Lowercase}/u.test('a'); //true
```

**White_Space** ï¼šæ•è·ç©ºæ ¼
```
/\p{White_Space}/u.test(' ') //true
```

**Emoji** ï¼š æ•è·emojiè¡¨æƒ…

```
/\p{Emoji}/u.test('ğŸ™ƒ');    //true
```

è¿™é‡Œåˆ—å‡ºäº†éƒ¨åˆ†çš„unicodeå…³é”®å­—ï¼Œè¿˜æœ‰å…¶ä»–æ›´å¤šå¯ä»¥æŸ¥çœ‹[https://github.com/tc39/proposal-regexp-unicode-property-escapes](https://github.com/tc39/proposal-regexp-unicode-property-escapes)


## ä¸‰ã€å¼‚æ­¥è¿­ä»£å™¨å’Œå¼‚æ­¥ç”Ÿæˆå™¨

#### è¿­ä»£å™¨å’Œç”Ÿæˆå™¨

è¿­ä»£å™¨ï¼ˆIteratorï¼‰å’Œç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰äºES6ä¸­æå‡ºã€‚

Iteratorä¸»è¦ç”¨äºéå†ä¸åŒçš„æ•°æ®ç»“æ„ï¼Œéå†çš„æ•°æ®ç»“æ„è¦å…·æœ‰`Symbol.iterator`å±æ€§ã€‚Iteratorä¸­åŒ…å«`next`æ–¹æ³•ï¼Œè°ƒç”¨`next`æ–¹æ³•å¯ä»¥è¿”å›ä¸¤ä¸ªå€¼ä¸º`value`å’Œ`done`ï¼Œ`value`ä¸ºè¿”å›çš„å€¼ï¼Œ`done`ä¸ºæ ‡è¯†éå†æ˜¯å¦ç»“æŸï¼Œå½“ä¸º`false`æ—¶ï¼Œéå†æœªç»“æŸï¼Œå½“ä¸º`true`æ—¶ï¼Œéå†ç»“æŸã€‚ES6æä¾›äº†`for...of`æ¥éå†Iteratoræ•°æ®ã€‚

æ•°ç»„æ˜¯é»˜è®¤å…·æœ‰`Symbol.iterator`å±æ€§çš„ï¼Œä»¥æ•°ç»„ä¸ºä¾‹ï¼š

```
const arr = ['a','b','c','d','e'];

console.log(typeof arr[Symbol.iterator]);   //function

for(let item of arr){
    console.log(item);
}
//a
//b
//c
//d
//e

```

Generatorå‡½æ•°æ˜¯ES6æä¾›çš„ä¸€ç§å¼‚æ­¥è§£å†³æ–¹æ¡ˆã€‚æ‰§è¡ŒGeneratorå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œè¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå†Generatorå‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚Generatorå‡½æ•°æœ‰ä¸¤ä¸ªç‰¹å¾ï¼Œä¸€æ˜¯`function`å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ª`*`å·ï¼ŒäºŒæ˜¯å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨`yield`è¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ã€‚

```
function* Test(){
	console.log('start');
	yield 1;
	yield 2;
	console.log('end');
	return 3;
}

const test = Test();

console.log(typeof test[Symbol.iterator]);  //function

test.next();    //start {value: 1, done: false}
test.next();    //{value: 2, done: false}
test.next();    //end {value: 3, done: true}
```

#### å¼‚æ­¥è¿­ä»£å™¨å’Œå¼‚æ­¥ç”Ÿæˆå™¨

å¼‚æ­¥è¿­ä»£å™¨ä¸åŒæ­¥è¿­ä»£å™¨çš„åŒºåˆ«åœ¨äºï¼ŒåŒæ­¥è¿­ä»£å™¨çš„`next`æ–¹æ³•è¿”å›çš„æ˜¯åŒ…å«`value`å’Œ`done`çš„å¯¹è±¡ï¼Œå¼‚æ­¥è¿­ä»£å™¨çš„`next`æ–¹æ³•è¿”å›çš„æ˜¯promiseå¯¹è±¡ï¼Œä¸”promiseå¯¹è±¡å›è°ƒä¸­å‚æ•°åŒ…å«`value`å’Œ`done`å¯¹è±¡ã€‚å¼‚æ­¥è¿­ä»£å™¨ä¸­åŒ…å«çš„`Symbol.asyncIterator`å±æ€§ã€‚

```
asyncIterator.next().then(({value , done}) => {
    console.log(value , done);
})
```

å¼‚æ­¥ç”Ÿæˆå™¨ä¸æ™®é€šç”Ÿæˆå™¨åœ¨äºï¼Œå¼‚æ­¥ç”Ÿæˆå™¨çš„å®šä¹‰åŠ å…¥äº†`async`ï¼Œä¸”å†…éƒ¨å¯ä»¥ä½¿ç”¨`await`ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå…·æœ‰`Symbol.asyncIterator`æ–¹æ³•çš„å¯¹è±¡ã€‚å› æ­¤å¯ä»¥ç”¨å¼‚æ­¥ç”Ÿæˆå™¨åˆ›å»ºå¼‚æ­¥è¿­ä»£å™¨ã€‚

```
async function* Test(){
    yield await Promise.resolve(1);
    yield await Promise.resolve(2);
    yield await Promise.resolve(3);
}

const test = Test();

console.log(test[Symbol.asyncIterator]);    //function
```

`for...of`åªèƒ½ç”¨æ¥éå†åŒæ­¥è¿­ä»£å™¨ï¼Œå› æ­¤ES9æä¾›äº†`for...await...of`æ¥éå†å¼‚æ­¥è¿­ä»£å™¨ã€‚

```
for await (const item of test){
    console.log(item);
}
//1
//2
//3
```

<br/>

## å››ã€Promiseçš„finallyå›è°ƒ

åœ¨ES9ä¸­ï¼Œæ–°å¢äº†Promiseçš„`finally`å›è°ƒå‡½æ•°ï¼Œæ— è®ºPromiseè¿”å›ç»“æœæ˜¯æˆåŠŸæ‰§è¡Œ`then()`è¿˜æ˜¯å¤±è´¥æ‰§è¡Œ`catch()`ï¼Œéƒ½ä¼šæ‰§è¡Œ`finally`å›è°ƒå‡½æ•°ã€‚

```
function test(num){
	return new Promise((resolve , reject) => {
		if(num == 1){
			resolve()
		}else{
			reject();
        }
	})
}

test(1).then(() => {
	console.log('success')
}).finally(() => {
	console.log('finally')
})
//success
//finally

test(2).catch(() => {
	console.log('error')
}).finally(() => {
	console.log('finally')
})
//error 
//finally
```


<br/>

## å‚è€ƒæ–‡æ¡£

[1.THE ES2018 GUIDE](https://flaviocopes.com/es2018/)<br/>
[2.ES9ä¸­çš„å¼‚æ­¥è¿­ä»£å™¨ï¼ˆAsync iteratorï¼‰å’Œå¼‚æ­¥ç”Ÿæˆå™¨ï¼ˆAsync generatorï¼‰](https://juejin.im/post/5c0fd5a26fb9a049c30b17fe)